(this["webpackJsonpreactions-assignment"]=this["webpackJsonpreactions-assignment"]||[]).push([[0],{51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var c=n(4),a=n.n(c),r=n(22),i=n.n(r),s=n(9),o=n(12),u=n.n(o),d=n(25),l=n(17),j=n(27),_="https://artful-iudex.herokuapp.com",b=function(e){return fetch("".concat(_,"/").concat(e)).then((function(e){return e.json()}))},f=function(){return b("reactions")},p=function(){return b("users")},m=function(){return b("user_content_reactions")},x=function(e){return function(e,t){return fetch("".concat(_,"/").concat(e),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()}))}("user_content_reactions",e)},h=function(e){return t="user_content_reactions/".concat(e),fetch("".concat(_,"/").concat(t),{method:"delete"});var t},O=25,v=n(2);var y=function(e){var t=e.emojiData,n=e.reaction_data,c=e.setReactions,a=e.content_reactions,r=e.addReactionMutation,i=e.deleteeReactionMutation,s=e.content_id,o=function(){var e=Object(l.a)(u.a.mark((function e(){var o,l,j,_;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j=0;case 1:if(!(j<n.length)){e.next=9;break}if(n[j].user_id!==O){e.next=6;break}return o=j,l=n[j],e.abrupt("break",9);case 6:j++,e.next=1;break;case 9:if(!(o>=0)){e.next=15;break}return e.next=12,i.mutateAsync(l.reaction_id);case 12:n.splice(o,1),e.next=19;break;case 15:return e.next=17,r.mutateAsync({user_id:O,reaction_id:t.id,content_id:s});case 17:_=e.sent,n.push({user_id:O,reaction_id:_.id});case 19:c(Object(d.a)({},a));case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=n.some((function(e){return e.user_id===O}));return n.length>0?Object(v.jsx)("div",{className:"reactionTile_contaner",onClick:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o());case 1:case"end":return e.stop()}}),e)}))),style:{backgroundColor:j?"#EDF5FF":"#F4F4F4",border:j?"1px solid #0F62FE":"1px solid #FFFFFF"},children:Object(v.jsxs)("p",{className:"reactionTile_name",children:[t.emoji," . ",n.length]})}):null};var g=function(e){var t,n=e.data,a=e.content_reactions,r=e.content_id,i=Object(c.useState)(!1),o=Object(j.a)(i,2),_=o[0],b=o[1],f=Object(c.useState)(a),p=Object(j.a)(f,2),m=p[0],g=p[1],k=Object(s.useMutation)(x),N=Object(s.useMutation)(h),F=Object.keys(m),R=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,c,a,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=m[t.id])||(m[t.id]=[],n=m[t.id]),i=0;case 3:if(!(i<n.length)){e.next=11;break}if(n[i].user_id!==O){e.next=8;break}return c=i,a=n[i],e.abrupt("break",11);case 8:i++,e.next=3;break;case 11:if(!(c>=0)){e.next=17;break}return e.next=14,N.mutateAsync(a.reaction_id);case 14:n.splice(c,1),e.next=21;break;case 17:return e.next=19,k.mutateAsync({user_id:O,reaction_id:t.id,content_id:r});case 19:s=e.sent,n.push({user_id:O,reaction_id:s.id});case 21:g(Object(d.a)({},m));case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"reactions",children:[F.map((function(e){var t,c=(t=e,n.find((function(e){return e.id==t})));return Object(v.jsx)(y,{emojiData:c,reaction_data:m[e],content_reactions:a,setReactions:g,deleteeReactionMutation:N,addReactionMutation:k,content_id:r},e.reaction_id)})),Object(v.jsxs)("div",{className:"rections_listIcon",onClick:function(){return b((function(e){return!e}))},onMouseLeave:function(){t=setTimeout((function(){b(!1)}),800)},children:[_&&Object(v.jsx)("div",{className:"reaction_listContainer",onClick:function(e){return e.stopPropagation()},onMouseEnter:function(){return clearTimeout(t)},children:n.map((function(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{className:"reaction_emojiIcon",onClick:function(){return R(e)},children:e.emoji},e.id),Object(v.jsx)("div",{className:"reaction_tooltip",children:Object(v.jsx)("p",{className:"reaction_reactionName",children:e.name})})]},e.id)}))}),Object(v.jsx)("img",{src:"/media/addReactionIcon.svg",alt:"addReaction",style:{marginRight:1}})]})]})};var k=function(e){var t=e.reactions_list,n=e.content,c=e.content_reactions,a=n.posted_by;return Object(v.jsxs)("div",{className:"post",children:[Object(v.jsx)("img",{className:"post_avatar",src:a.avatar,alt:a.first_name}),Object(v.jsxs)("div",{children:[Object(v.jsxs)("p",{className:"post_postedBy",children:[a.first_name," ",a.last_name]}),"TEXT"===n.type?Object(v.jsx)("p",{className:"post_text",children:n.text}):Object(v.jsx)("img",{className:"post_media",src:null===n||void 0===n?void 0:n.image,alt:"scenary"}),Object(v.jsx)(g,{data:t,content_reactions:c,content_id:n.id})]})]})},N=(n(51),n(38)),F=n(37);var R=function(){var e=Object(s.useQuery)("getReactions",f).data,t=Object(s.useQuery)("getUsers",p).data,n=Object(s.useQuery)("getUserContentReactions",m).data;if(e&&t&&n){var c=[{id:1,type:"TEXT",text:"Hello this is good post comment",posted_by:t[0]},{id:2,type:"MEDIA",image:"/media/contentImage.jpeg",posted_by:t[1]}],a=function(e){var t,n={},c=Object(F.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value;n[a.content_id]||(n[a.content_id]={});var r=n[a.content_id];r[a.reaction_id]?r[a.reaction_id]=[].concat(Object(N.a)(r[a.reaction_id]),[{reaction_id:a.id,user_id:a.user_id}]):r[a.reaction_id]=[{reaction_id:a.id,user_id:a.user_id}]}}catch(i){c.e(i)}finally{c.f()}return n}(n);return Object(v.jsxs)("div",{className:"container",children:[Object(v.jsxs)("p",{className:"container_headerText",children:["You are logged in as user id: ",O]}),c.map((function(t){return Object(v.jsx)(k,{reactions_list:e,content:t,content_reactions:a[t.id]},t.id)}))]})}return Object(v.jsx)("h3",{children:"Loading..."})},T=new s.QueryClient({defaultOptions:{queries:{staleTime:1/0}}});var C=function(){return Object(v.jsx)(s.QueryClientProvider,{client:T,children:Object(v.jsx)(R,{})})};n(52);i.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(C,{})}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.ddef97ce.chunk.js.map